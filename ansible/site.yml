- hosts: all
  roles:
    - customize-user-ichimonji10
    - msmtp
    - nftables
    - pkgfile
    - reflector
    - smartd
    - time

- hosts: servers
  roles:
    - sshd
    - role: dynamic-dns
      when: dynamic_dns_urls is defined

- hosts: servers:beech.ichimonji10.name
  roles:
    - apcupsd

- hosts: servers:!routers
  roles:
    - netctl-generic
    - role: openvpn-client-ivpn
      when:
        - openvpn_client_ivpn_username is defined
        - openvpn_client_ivpn_password is defined

- hosts: routers
  roles:
    - dnsmasq
    # NOTE: Execute this play only over a wired connection.
    - role: hostapd
      when: hostapd_passphrase is defined
    - netctl-routers
    - wlan-secure

- hosts: vm-hosts
  roles:
    # NOTE: After running, add authorized users to appropriate groups.
    - libvirtd

- hosts: btrfs-hosts
  roles:
    - btrfs-scrub
    - role: btrfs-snapshot
      when: btrfs_snapshot

- hosts: pine.ichimonji10.name
  roles:
    # NOTE: Ensure user has an SSH key for logging into remote backup hosts.
    - role: borg-backup
      when:
        - borg_backup_passphrase is defined
        - borg_backup_user is defined
  vars:
    borg_backup_directories:
      - ~/books
      - ~/docs
      - ~/pictures
    borg_backup_user: ichimonji10

- hosts: pine.ichimonji10.name
  roles:
    # NOTE: Ensure user has an SSH key for logging into remote backup hosts.
    - role: borg-backup
      when:
        - borg_backup_passphrase is defined
        - borg_backup_user is defined
  vars:
    borg_backup_user: googoo

- hosts: pine.ichimonji10.name
  roles:
    - subsonic

- hosts: pine.ichimonji10.name
  roles:
    # NOTE: Ensure user has an SSH key for logging into remote backup hosts.
    - role: borg-backup
      when:
        - borg_backup_passphrase is defined
        - borg_backup_user is defined
  vars:
    borg_backup_directories:
      - ~/backups
    borg_backup_user: subsonic-backup
